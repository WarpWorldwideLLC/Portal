<%@page trimDirectiveWhitespaces="true"%>
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<%@taglib prefix="botDetect" uri="https://captcha.com/java/jsp"%>
<c:set var="language" value="${not empty param.language ? param.language : not empty language ? language : pageContext.request.locale}" scope="session" />
<fmt:setLocale value="${language}" />
<fmt:setBundle basename="com.warpww.web.i18n.register" />

<!DOCTYPE html>
<html>
    <head>
    		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>WARP Registration</title>
        <script src="jsx/util.js"></script>
    </head>
<body>
		<%@include  file="/htx/LanguageSelector.html" %>

        <form method="post" action="/com.warpww.web/register" enctype="multipart/form-data" name="registration" autocomplete="off">
        <div>
	  		<br><label><fmt:message key="register.label.username" /></label> 
			<input type="text" name="memberName" id="memberName" value=${param["memberName"]}>
	  		<label>Email Address:</label>
	  		<input type="text" name="emailAddress" id="emailAddress" value=${param["emailAddress"]}>
	  		<br/>
	  	  	<label>Passphrase:</label>
	  		<input type="password" name="passPhrase1" id="passPhrase1" value=${param["passPhrase"]}>
	  		<br>
	  		<label>Re-Enter Passphrase:</label>
	  		<input type="password" name="passPhrase2" id="passPhrase2" value=${param["passPhrase"]}>
	  		<br>
	  		<button type="button" onclick="toggleHide2('passPhrase1','passPhrase2')" id="passToggle">Show/Hide Passphrase</button>
	  		<br/>
  			<button type="submit" value="native" name="btnNative">Join WARP Now!</button>
  		
  		</div>
  		<br>
  		<br>
  		<div>
  		            <label class="incorrect">${messages.loginError}</label>

            <%
                if ((request.getSession().getAttribute("isCaptchaSolved") == null) 
                        && (request.getAttribute("isLoggedIn") == null)) {
            %>
                    <label for="captchaCode" class="prompt">Retype the characters from the picture:</label>

                    <!-- Adding BotDetect Captcha to the page -->
                    <botDetect:captcha id="loginCaptcha" 
                                userInputID="captchaCode"
                                codeLength="4"
                                imageWidth="200"
                                codeStyle="ALPHA" />

                    <div class="validationDiv">
                        <input id="captchaCode" type="text" name="captchaCode" />
                        <span class="incorrect">${messages.captchaIncorrect}</span>
                    </div>
            <%
                }
            %>
            
            <% if (request.getAttribute("isLoggedIn") == null) { %>
                    <input type="submit" name="submitButton" id="submitButton" value="Login" />
            <% } else { %>
                    <a href="register.jsp">Back to login page.</a>
            <% } %>
  		
  		</div>
  		
  		<div>
	  		<label for="captchaCode" class="prompt">Retype the characters from the picture:</label>
	
	
	          <!-- Adding BotDetect Captcha to the page -->
	          <botDetect:captcha id="loginCaptcha" 
	                userInputID="captchaCode"
	                codeLength="4"
	                imageWidth="200"
	                codeStyle="ALPHA" />
	
	          <div class="validationDiv">
	            <input id="captchaCode" type="text" name="captchaCode" />
	            <span class="incorrect">${messages.captchaIncorrect}</span>
	          </div>		
  		</div>
  		  

	</form>
</body>
</html>